' ================================================ 
'   ðŸ—“ Fecha de creaciÃ³n: 2025-08-03
'   ðŸ›  PropÃ³sito: é¸æŠžãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œç´¢
'   Scripted with â¤ï¸  by Nahoko ï¼† Rodem XOXO
'   âˆ´ Reliable ï½œ Practical ï½œ a bit cheeky âˆµ 
'   ðŸ’» Â¡Transformando bits en arte, dÃ­a y noche!
' ================================================

Option Explicit

Dim shell, folder, folderPath, searchKeyword, result, fso
Set shell = CreateObject("Shell.Application")
Set fso = CreateObject("Scripting.FileSystemObject")

' ðŸ“ ãƒ•ã‚©ãƒ«ãƒ€é¸æŠžãƒ€ã‚¤ã‚¢ãƒ­ã‚°
Set folder = shell.BrowseForFolder(0, "ðŸ“ æ¤œç´¢ã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ã‚’é¸ã‚“ã§ã­", 0, 0)
If folder Is Nothing Then
    WScript.Echo "âŒ ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ"
    WScript.Quit
End If
folderPath = folder.Self.Path

' ðŸ” æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›
searchKeyword = InputBox("ðŸ” æ¤œç´¢ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«åã®ä¸€éƒ¨ã‚’å…¥åŠ›ã—ã¦ã­ï¼ˆä¾‹ï¼šãŠå¼å½“ã€.xlsxï¼‰", "æ¤œç´¢ãƒ•ã‚¡ã‚¤ãƒ«å")
If Trim(searchKeyword) = "" Then
    WScript.Echo "âŒ ãƒ•ã‚¡ã‚¤ãƒ«åãŒæœªå…¥åŠ›ãªã®ã§çµ‚äº†ã—ã¾ã™"
    WScript.Quit
End If

' æ¤œç´¢çµæžœã‚’æ ¼ç´
result = ""

' ðŸ” å†å¸°æ¤œç´¢å®Ÿè¡Œ
SearchFiles folderPath, searchKeyword

' çµæžœå‡¦ç†
If result = "" Then
    MsgBox "ðŸ˜¿ è©²å½“ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚", vbExclamation, "æ¤œç´¢çµæžœ"
Else
    Dim tempFile, txtFile
    tempFile = fso.GetSpecialFolder(2) & "\æ¤œç´¢çµæžœ_" & Replace(Replace(Now, "/", "-"), ":", "-") & ".txt"
    Set txtFile = fso.CreateTextFile(tempFile, True)
    txtFile.Write result
    txtFile.Close
    MsgBox "âœ… æ¤œç´¢çµæžœã‚’ãƒ¡ãƒ¢å¸³ã§é–‹ãã¾ã™ã€‚" & vbCrLf & vbCrLf & tempFile, vbInformation, "å®Œäº†"
    CreateObject("WScript.Shell").Run "notepad.exe """ & tempFile & """"
End If

' === ðŸ§  å†å¸°ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢ã‚µãƒ–ãƒ«ãƒ¼ãƒãƒ³ ===
Sub SearchFiles(ByVal targetFolder, ByVal keyword)
    Dim file, subfolder
    For Each file In fso.GetFolder(targetFolder).Files
        If InStr(LCase(file.Name), LCase(keyword)) > 0 Then
            result = result & file.Path & vbCrLf
        End If
    Next
    For Each subfolder In fso.GetFolder(targetFolder).SubFolders
        SearchFiles subfolder.Path, keyword
    Next
End Sub
