' ================================================ 
'   ğŸ—“ Fecha de creaciÃ³n: 2025-08-03
'   ğŸ›  PropÃ³sito: é¸æŠãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œç´¢
'   Scripted with â¤ï¸  by Nahoko ï¼† Rodem XOXO
'   âˆ´ Reliable ï½œ Practical ï½œ a bit cheeky âˆµ 
'   ğŸ’» Â¡Transformando bits en arte, dÃ­a y noche!
' ================================================

Option Explicit

Dim shell, folder, folderPath, searchPattern, result
Set shell = CreateObject("Shell.Application")

' ãƒ•ã‚©ãƒ«ãƒ€é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°
Set folder = shell.BrowseForFolder(0, "ğŸ“ æ¤œç´¢ã™ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ã‚’é¸ã‚“ã§ã­", 0, 0)
If folder Is Nothing Then
    WScript.Echo "âŒ ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ"
    WScript.Quit
End If
folderPath = folder.Self.Path

' æ¤œç´¢ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å…¥åŠ›ï¼ˆä¾‹ï¼š*.xlsxï¼‰
searchPattern = InputBox("ğŸ” æ¤œç´¢ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«åï¼ˆä¾‹ï¼š*.txt ã‚„ äºˆç®—æ›¸*.xlsï¼‰ã‚’å…¥åŠ›ã—ã¦ã­", "æ¤œç´¢ãƒ•ã‚¡ã‚¤ãƒ«å")
If Trim(searchPattern) = "" Then
    WScript.Echo "âŒ ãƒ•ã‚¡ã‚¤ãƒ«åãŒæœªå…¥åŠ›ãªã®ã§çµ‚äº†ã—ã¾ã™"
    WScript.Quit
End If

' çµæœæ ¼ç´ç”¨
result = ""

' å†å¸°çš„ã«æ¤œç´¢
Call SearchFiles(folderPath, searchPattern)

If result = "" Then
    MsgBox "ğŸ˜¿ è©²å½“ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚", vbExclamation, "æ¤œç´¢çµæœ"
Else
    ' çµæœã‚’è¡¨ç¤ºï¼†ä¿å­˜
    Dim tempFile, fso, txtFile
    Set fso = CreateObject("Scripting.FileSystemObject")
    tempFile = fso.GetSpecialFolder(2) & "\æ¤œç´¢çµæœ_" & Replace(Replace(Now, "/", "-"), ":", "-") & ".txt"
    Set txtFile = fso.CreateTextFile(tempFile, True)
    txtFile.Write result
    txtFile.Close
    MsgBox "âœ… æ¤œç´¢çµæœã‚’ãƒ¡ãƒ¢å¸³ã§é–‹ãã¾ã™ã€‚" & vbCrLf & vbCrLf & tempFile, vbInformation, "å®Œäº†"
    CreateObject("WScript.Shell").Run "notepad.exe """ & tempFile & """"
End If

' å†å¸°æ¤œç´¢å‡¦ç†
Sub SearchFiles(ByVal targetFolder, ByVal pattern)
    Dim folder, file, subfolder, fso
    Set fso = CreateObject("Scripting.FileSystemObject")
    For Each file In fso.GetFolder(targetFolder).Files
        If LCase(file.Name) Like LCase(pattern) Then
            result = result & file.Path & vbCrLf
        End If
    Next
    For Each subfolder In fso.GetFolder(targetFolder).SubFolders
        Call SearchFiles(subfolder.Path, pattern)
    Next
End Sub
